<!-- src/app/pages/admin/admin-product-form/admin-product-form.component.html -->
<div class="admin-product-form-container">
    <div class="row g-0">
      <!-- Sidebar -->
      <div class="col-md-2 bg-dark min-vh-100">
        <app-admin-sidebar></app-admin-sidebar>
      </div>
      
      <!-- Main content -->
      <div class="col-md-10">
        <app-admin-header></app-admin-header>
        
        <div class="container mt-4">
          <div class="row mb-4">
            <div class="col">
              <h2>{{isEditMode ? 'Edit' : 'Add'}} Product</h2>
              <p class="text-muted">{{isEditMode ? 'Update product information' : 'Create a new product'}}</p>
            </div>
            <div class="col-auto">
              <button 
                type="button" 
                class="btn btn-outline-secondary me-2" 
                routerLink="/admin/products"
              >
                <i class="bi bi-arrow-left me-2"></i>Back to Products
              </button>
            </div>
          </div>
          
          <!-- Loading spinner -->
          <div *ngIf="isLoading" class="d-flex justify-content-center my-5">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
          </div>
          
          <!-- Product form -->
          <div class="card" *ngIf="!isLoading">
            <div class="card-body">
              <form [formGroup]="productForm" (ngSubmit)="onSubmit()">
                <div class="row g-4">
                  <!-- Basic Information -->
                  <div class="col-md-8">
                    <div class="card">
                      <div class="card-header bg-light">
                        <h5 class="mb-0">Basic Information</h5>
                      </div>
                      <div class="card-body">
                        <!-- Product Name -->
                        <div class="mb-3">
                          <label for="name" class="form-label">Product Name <span class="text-danger">*</span></label>
                          <input 
                            type="text" 
                            class="form-control" 
                            id="name" 
                            formControlName="name"
                            [ngClass]="{'is-invalid': isFieldInvalid('name')}"
                          >
                          <div class="invalid-feedback" *ngIf="isFieldInvalid('name')">
                            {{getErrorMessage('name')}}
                          </div>
                        </div>
                        
                        <!-- Product Description -->
                        <div class="mb-3">
                          <label for="description" class="form-label">Description <span class="text-danger">*</span></label>
                          <textarea 
                            class="form-control" 
                            id="description" 
                            rows="5" 
                            formControlName="description"
                            [ngClass]="{'is-invalid': isFieldInvalid('description')}"
                          ></textarea>
                          <div class="invalid-feedback" *ngIf="isFieldInvalid('description')">
                            {{getErrorMessage('description')}}
                          </div>
                        </div>
                        
                        <div class="row">
                          <!-- Category -->
                          <div class="col-md-6 mb-3">
                            <label for="categoryId" class="form-label">Category <span class="text-danger">*</span></label>
                            <select 
                              class="form-select" 
                              id="categoryId" 
                              formControlName="categoryId"
                              [ngClass]="{'is-invalid': isFieldInvalid('categoryId')}"
                            >
                              <option value="">Select a category</option>
                              <option *ngFor="let category of categories" [value]="category.id">
                                {{category.name}}
                              </option>
                            </select>
                            <div class="invalid-feedback" *ngIf="isFieldInvalid('categoryId')">
                              {{getErrorMessage('categoryId')}}
                            </div>
                          </div>
                          
                          <!-- Seller -->
                          <div class="col-md-6 mb-3">
                            <label for="sellerId" class="form-label">Seller <span class="text-danger">*</span></label>
                            <select 
                              class="form-select" 
                              id="sellerId" 
                              formControlName="sellerId"
                              [ngClass]="{'is-invalid': isFieldInvalid('sellerId')}"
                            >
                              <option value="">Select a seller</option>
                              <option *ngFor="let seller of sellers" [value]="seller.id">
                                {{seller.storeName}}
                              </option>
                            </select>
                            <div class="invalid-feedback" *ngIf="isFieldInvalid('sellerId')">
                              {{getErrorMessage('sellerId')}}
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Pricing and Inventory -->
                  <div class="col-md-4">
                    <div class="card mb-4">
                      <div class="card-header bg-light">
                        <h5 class="mb-0">Pricing & Inventory</h5>
                      </div>
                      <div class="card-body">
                        <!-- Regular Price -->
                        <div class="mb-3">
                          <label for="price" class="form-label">Price (₦) <span class="text-danger">*</span></label>
                          <input 
                            type="number" 
                            class="form-control" 
                            id="price" 
                            formControlName="price"
                            [ngClass]="{'is-invalid': isFieldInvalid('price')}"
                          >
                          <div class="invalid-feedback" *ngIf="isFieldInvalid('price')">
                            {{getErrorMessage('price')}}
                          </div>
                        </div>
                        
                        <!-- Discount Price -->
                        <div class="mb-3">
                          <label for="discountPrice" class="form-label">Discount Price (₦)</label>
                          <input 
                            type="number" 
                            class="form-control" 
                            id="discountPrice" 
                            formControlName="discountPrice"
                          >
                          <small class="text-muted">Leave empty for no discount</small>
                        </div>
                        
                        <!-- Stock -->
                        <div class="mb-3">
                          <label for="stock" class="form-label">Stock Quantity <span class="text-danger">*</span></label>
                          <input 
                            type="number" 
                            class="form-control" 
                            id="stock" 
                            formControlName="stock"
                            [ngClass]="{'is-invalid': isFieldInvalid('stock')}"
                          >
                          <div class="invalid-feedback" *ngIf="isFieldInvalid('stock')">
                            {{getErrorMessage('stock')}}
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <!-- Status and Visibility -->
                    <div class="card">
                      <div class="card-header bg-light">
                        <h5 class="mb-0">Status & Visibility</h5>
                      </div>
                      <div class="card-body">
                        <!-- Status -->
                        <div class="mb-3">
                          <label for="status" class="form-label">Status <span class="text-danger">*</span></label>
                          <select 
                            class="form-select" 
                            id="status" 
                            formControlName="status"
                          >
                            <option value="active">Active</option>
                            <option value="inactive">Inactive</option>
                            <option value="draft">Draft</option>
                          </select>
                        </div>
                        
                        <!-- Featured -->
                        <div class="form-check form-switch mb-3">
                          <input 
                            class="form-check-input" 
                            type="checkbox" 
                            id="featured" 
                            formControlName="featured"
                          >
                          <label class="form-check-label" for="featured">Featured Product</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Product Image -->
                  <div class="col-md-12">
                    <div class="card">
                      <div class="card-header bg-light">
                        <h5 class="mb-0">Product Images</h5>
                      </div>
                      <div class="card-body">
                        <div class="mb-3">
                          <label for="image" class="form-label">Main Image URL <span class="text-danger">*</span></label>
                          <input 
                            type="text" 
                            class="form-control" 
                            id="image" 
                            formControlName="image"
                            [ngClass]="{'is-invalid': isFieldInvalid('image')}"
                          >
                          <div class="invalid-feedback" *ngIf="isFieldInvalid('image')">
                            {{getErrorMessage('image')}}
                          </div>
                          <small class="text-muted">In a real implementation, this would be an image upload.</small>
                        </div>
                        
                        <div class="mb-3">
                          <label class="form-label">Preview</label>
                          <div class="border rounded p-3 d-flex justify-content-center">
                            <img 
                              [src]="productForm.get('image')?.value" 
                              class="img-fluid" 
                              style="max-height: 200px;" 
                              *ngIf="productForm.get('image')?.value"
                              alt="Product preview"
                            >
                            <div class="text-muted" *ngIf="!productForm.get('image')?.value">
                              No image URL provided
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  
                  <!-- Submit buttons -->
                  <div class="col-12 mt-4">
                    <div class="d-flex justify-content-end">
                      <button 
                        type="button" 
                        class="btn btn-outline-secondary me-2" 
                        routerLink="/admin/products"
                      >
                        Cancel
                      </button>
                      <button 
                        type="submit" 
                        class="btn btn-primary" 
                        [disabled]="productForm.invalid || isLoading"
                      >
                        <i class="bi" [ngClass]="isEditMode ? 'bi-check-circle' : 'bi-plus-circle'"></i>
                        {{isEditMode ? 'Update' : 'Create'}} Product
                      </button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>